@{
    ViewBag.Title = "EditResources";
    Layout = "~/Views/Shared/MasterPage.cshtml";
}

@model ShowRommSys.Client.Web.Models.Resources
<link href="../../Content/uploadify.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" language="javascript" src="../../Scripts/jquery.uploadify.v2.1.4.js"></script>
<script src="../../Scripts/swfobject.js" type="text/javascript"></script>
<script>$.ajaxSetup({cache:false});</script>
<script type="text/javascript">
//    $(function () {
//        $("input[name=Type]").click(function () {
//            $("p[id^=Type]").hide();
//            $("#Type" + $(this).val()).show();
//        });
//    });
    $(function () {
        $('#videofileInput').uploadify({
            'uploader': '../../Content/uploadify.swf',
            'script': '/Site/UploadFile',
            'folder': '/UploadFiles/',
            'cancelImg': '../../Images/Cancel.png',
            'sizeLimit': 1024 * 1024 * 4 * 25, //100M
            'multi': false,
            'onSelect': onSelect,
            'onComplete': funvideo,
            'onError': onError
        });
    });
    function onError(event, queueID, fileObj) {
        alert("文件:" + fileObj.name + "上传失败");
    }
    function onSelect(e, queueId, fileObj) {
    }
    function funvideo(event, queueID, fileObj, response, data) {
        if (response != "") {
            $("#Uri").val(response);
        }
        else {
            alert("文件上传出错！");
        }
    };
</script>
<div class="box corner-top">
    @using (Html.BeginForm())
    {
        @Html.ValidationSummary(true)
        <div class="form">
            <p>
                <label class="field">
                    资源名：</label>@Model.Name</p>
                    <input type="hidden" value="@Model.Type" id="Type" name="Type"/>
                    <input type="hidden" value="@Model.CreateTime" id="CreateTime" name="CreateTime"/>
                    <input type="hidden" value="@Model.Approve" id="Approve" name="Approve"/>
            <div class="hr">
            @if (Model.Type == 1)
            {
                <p id="Type1">
                    <label class="field">
                        上传文件：</label>
                    <input id="videofileInput" name="videofileInput" type="file" />
                    <a href="javascript:$('#videofileInput').uploadifyUpload()">上传</a><input type="hidden" id="Uri" name="Uri" value="@Model.Uri"/>
                </p>
            }
            else
            {
                <p id="Type2" style="">
                    <label class="field">
                        URL地址：</label><input name="Uri" type="text" class="text" size="70" value="@Model.Uri"/></p>
            }
                <p>
                    <label class="field">
                        备注：</label><textarea name="Remark" class="text full" rows="5" id="Remark">@Model.Remark</textarea></p>
            </div>
            <p><button type="submit">提交</button>&nbsp;<a href="@Url.Content("~/site/IndexResources")" class="btn-69">返回</a></p>
        </div>
    }
</div>
